\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={Module 4 - Assignment},
            pdfauthor={Edvin Ahlander (23826)},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{Module 4 - Assignment}
\author{Edvin Ahlander (23826)}
\date{4/17/2020}

\begin{document}
\maketitle

In the next assignment we want to replicate some plots from the paper
``Female Socialization: How Daughters Affect Their Legislator Fathers'
Voting on Women's Issues'' (Washington, 2008). The paper explores
whether having a daughter makes politicians more sensitive to women's
rights issues and how this is reflected in their voting behavior. The
main identifying assumption is that after controlling for the number of
children, the gender composition is random. This might be violated if
families that have a preference for girls keep having children until
they have a girl. In this assignment we will prepare a dataset that
allows us to test whether families engage in such a ``female child
stopping rule''.

I encourage you to take a look at the paper, as we will come back to it
later in the course.

\section{Setup}\label{setup}

\begin{itemize}
\tightlist
\item
  Load the libraries ``Rio'' and ``tidyverse''
\item
  Change the path of the working directory to your working directory.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(rio)}
\KeywordTok{library}\NormalTok{(tidyverse)}
\KeywordTok{library}\NormalTok{(foreign)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  import the data sets \emph{basic.dta} and \emph{genold108.dta}
\item
  create a subset of the 108th congress from the \emph{basic} dataset
\item
  join this subset with the \emph{genold} dataset
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{basic <-}\StringTok{ }\KeywordTok{read.dta}\NormalTok{(}\StringTok{"basic.dta"}\NormalTok{)}
\NormalTok{genold <-}\StringTok{ }\KeywordTok{read.dta}\NormalTok{(}\StringTok{"genold108.dta"}\NormalTok{)}

\NormalTok{basic108 <-}\StringTok{ }\NormalTok{basic }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(basic}\OperatorTok{$}\NormalTok{congress }\OperatorTok{==}\StringTok{ }\DecValTok{108}\NormalTok{)}

\NormalTok{basic108 <-}\StringTok{ }\KeywordTok{merge}\NormalTok{(genold, basic108, }\DataTypeTok{by=}\KeywordTok{c}\NormalTok{(}\StringTok{"district"}\NormalTok{, }\StringTok{"statenam"}\NormalTok{, }\StringTok{"name"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\section{Data preparation}\label{data-preparation}

\begin{itemize}
\tightlist
\item
  check table 1 in the appendix of the paper and decide which variables
  are necessary for the analysis (check the footnote for control
  variables)
\item
  drop all other variables.
\item
  Recode \emph{genold} such that gender is a factor variable and missing
  values are coded as NAs.
\item
  Recode \emph{party} as a factor with 3 levels (D, R, I)
\item
  Recode \emph{rgroup} and \emph{region} as factors.
\item
  generate variables for age squared and service length squared
\item
  create an additional variable of the number of children as factor
  variable
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{basic108 <-}\StringTok{ }\NormalTok{basic108 }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{(name, totchi, ngirls, genold, white, female, party, age, srvlng, rgroup, region)}

\NormalTok{basic108}\OperatorTok{$}\NormalTok{genold <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(basic108}\OperatorTok{$}\NormalTok{genold)}
\NormalTok{basic108}\OperatorTok{$}\NormalTok{genold[basic108}\OperatorTok{$}\NormalTok{genold }\OperatorTok{==}\StringTok{ ""}\NormalTok{] <-}\StringTok{ }\OtherTok{NA}

\NormalTok{basic108}\OperatorTok{$}\NormalTok{party <-}\StringTok{ }\KeywordTok{factor}\NormalTok{(basic108}\OperatorTok{$}\NormalTok{party, levels <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{), labels <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"D"}\NormalTok{, }\StringTok{"R"}\NormalTok{, }\StringTok{"I"}\NormalTok{))}

\NormalTok{basic108}\OperatorTok{$}\NormalTok{rgroup <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(basic108}\OperatorTok{$}\NormalTok{rgroup)}
\NormalTok{basic108}\OperatorTok{$}\NormalTok{region <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(basic108}\OperatorTok{$}\NormalTok{region)}

\NormalTok{basic108}\OperatorTok{$}\NormalTok{agesq <-}\StringTok{ }\NormalTok{basic108}\OperatorTok{$}\NormalTok{age}\OperatorTok{^}\DecValTok{2}
\NormalTok{basic108}\OperatorTok{$}\NormalTok{srvlngsq <-}\StringTok{ }\NormalTok{basic108}\OperatorTok{$}\NormalTok{srvlng}\OperatorTok{^}\DecValTok{2}

\NormalTok{basic108}\OperatorTok{$}\NormalTok{totchifac <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(basic108}\OperatorTok{$}\NormalTok{totchi)}
\end{Highlighting}
\end{Shaded}

\section{Replicationg Table 1 from the
Appendix}\label{replicationg-table-1-from-the-appendix}

We haven't covered regressions in R yet. Use the function \emph{lm()}.
The function takes the regression model (formula) and the data as an
input. The model is written as \(y \ \tilde \quad x\), where \(x\)
stands for any linear combination of regressors. Use the help file to
understand the function.

\begin{itemize}
\tightlist
\item
  Run the regression
  \(total.children = \beta_0 + \beta_1 gender.oldest + \gamma'X\) where
  \(\gamma\) stands for a vector of coefficients and \(X\) is a matrix
  that contains all columns that are control
  variables.\footnote{This is just a short notation instead of writing the full model with all control variables $totchi = \beta_0 + \beta_1 genold + \gamma_1 age + \gamma_2 age^2 + \gamma_3 Democrat + ... + \epsilon$ which quickly gets out of hand for large models.}
\item
  Save the main coefficient of interest (\(\beta_1\))
\item
  Run the same regression separately for Democrats (including Bernie)
  and Republicans. Save the coefficient and standard error of
  \emph{genold}
\item
  Collect all the \emph{genold} coefficients from the six regressions,
  including their standard errors and arrange them in a table as in the
  paper.
\item
  print the table
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{reg1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(totchi }\OperatorTok{~}\StringTok{ }\NormalTok{genold }\OperatorTok{+}\StringTok{ }\NormalTok{white }\OperatorTok{+}\StringTok{ }\NormalTok{female }\OperatorTok{+}\StringTok{ }\NormalTok{party }\OperatorTok{+}\StringTok{ }\NormalTok{age }\OperatorTok{+}\StringTok{ }\NormalTok{srvlng }\OperatorTok{+}\StringTok{ }\NormalTok{rgroup }\OperatorTok{+}\StringTok{ }\NormalTok{region }\OperatorTok{+}\StringTok{ }\NormalTok{agesq }\OperatorTok{+}\StringTok{ }\NormalTok{srvlngsq, }\DataTypeTok{data =}\NormalTok{ basic108)}

\NormalTok{reg2 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(ngirls }\OperatorTok{~}\StringTok{ }\NormalTok{genold }\OperatorTok{+}\StringTok{ }\NormalTok{white }\OperatorTok{+}\StringTok{ }\NormalTok{female }\OperatorTok{+}\StringTok{ }\NormalTok{party }\OperatorTok{+}\StringTok{ }\NormalTok{age }\OperatorTok{+}\StringTok{ }\NormalTok{srvlng }\OperatorTok{+}\StringTok{ }\NormalTok{rgroup }\OperatorTok{+}\StringTok{ }\NormalTok{region }\OperatorTok{+}\StringTok{ }\NormalTok{agesq }\OperatorTok{+}\StringTok{ }\NormalTok{srvlngsq }\OperatorTok{+}\StringTok{ }\NormalTok{totchifac, }\DataTypeTok{data =}\NormalTok{ basic108)}

\NormalTok{reg3 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(totchi }\OperatorTok{~}\StringTok{ }\NormalTok{genold }\OperatorTok{+}\StringTok{ }\NormalTok{white }\OperatorTok{+}\StringTok{ }\NormalTok{female }\OperatorTok{+}\StringTok{ }\NormalTok{age }\OperatorTok{+}\StringTok{ }\NormalTok{srvlng }\OperatorTok{+}\StringTok{ }\NormalTok{rgroup }\OperatorTok{+}\StringTok{ }\NormalTok{region }\OperatorTok{+}\StringTok{ }\NormalTok{agesq }\OperatorTok{+}\StringTok{ }\NormalTok{srvlngsq, }\DataTypeTok{data=}\KeywordTok{subset}\NormalTok{(basic108, party }\OperatorTok{==}\StringTok{ "D"} \OperatorTok{|}\StringTok{ }\NormalTok{party }\OperatorTok{==}\StringTok{ "I"}\NormalTok{))}

\NormalTok{reg4 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(ngirls }\OperatorTok{~}\StringTok{ }\NormalTok{genold }\OperatorTok{+}\StringTok{ }\NormalTok{white }\OperatorTok{+}\StringTok{ }\NormalTok{female }\OperatorTok{+}\StringTok{ }\NormalTok{age }\OperatorTok{+}\StringTok{ }\NormalTok{srvlng }\OperatorTok{+}\StringTok{ }\NormalTok{rgroup }\OperatorTok{+}\StringTok{ }\NormalTok{region }\OperatorTok{+}\StringTok{ }\NormalTok{agesq }\OperatorTok{+}\StringTok{ }\NormalTok{srvlngsq }\OperatorTok{+}\StringTok{ }\NormalTok{totchifac, }\DataTypeTok{data=}\KeywordTok{subset}\NormalTok{(basic108, party }\OperatorTok{==}\StringTok{ "D"} \OperatorTok{|}\StringTok{ }\NormalTok{party }\OperatorTok{==}\StringTok{ "I"}\NormalTok{))}

\NormalTok{reg5 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(totchi }\OperatorTok{~}\StringTok{ }\NormalTok{genold }\OperatorTok{+}\StringTok{ }\NormalTok{white }\OperatorTok{+}\StringTok{ }\NormalTok{female }\OperatorTok{+}\StringTok{ }\NormalTok{age }\OperatorTok{+}\StringTok{ }\NormalTok{srvlng }\OperatorTok{+}\StringTok{ }\NormalTok{rgroup }\OperatorTok{+}\StringTok{ }\NormalTok{region }\OperatorTok{+}\StringTok{ }\NormalTok{agesq }\OperatorTok{+}\StringTok{ }\NormalTok{srvlngsq, }\DataTypeTok{data=}\KeywordTok{subset}\NormalTok{(basic108, party }\OperatorTok{==}\StringTok{ "R"}\NormalTok{))}

\NormalTok{reg6 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(ngirls }\OperatorTok{~}\StringTok{ }\NormalTok{genold }\OperatorTok{+}\StringTok{ }\NormalTok{white }\OperatorTok{+}\StringTok{ }\NormalTok{female }\OperatorTok{+}\StringTok{ }\NormalTok{age }\OperatorTok{+}\StringTok{ }\NormalTok{srvlng }\OperatorTok{+}\StringTok{ }\NormalTok{rgroup }\OperatorTok{+}\StringTok{ }\NormalTok{region }\OperatorTok{+}\StringTok{ }\NormalTok{agesq }\OperatorTok{+}\StringTok{ }\NormalTok{srvlngsq }\OperatorTok{+}\StringTok{ }\NormalTok{totchifac, }\DataTypeTok{data=}\KeywordTok{subset}\NormalTok{(basic108, party }\OperatorTok{==}\StringTok{ "R"}\NormalTok{))}

\NormalTok{Betas <-}\StringTok{ }\KeywordTok{c}\NormalTok{(reg1}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{],reg2}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{],reg3}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{],reg4}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{],reg5}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{],reg6}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{])}

\NormalTok{output1 <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(reg1)}
\NormalTok{output2 <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(reg2)}
\NormalTok{output3 <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(reg3)}
\NormalTok{output4 <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(reg4)}
\NormalTok{output5 <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(reg5)}
\NormalTok{output6 <-}\StringTok{ }\KeywordTok{summary}\NormalTok{(reg6)}

\NormalTok{stderrors <-}\StringTok{ }\KeywordTok{c}\NormalTok{(output1}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{],output2}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{],output3}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{],output4}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{],output5}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{],output6}\OperatorTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{])}

\NormalTok{N <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{227}\NormalTok{,}\DecValTok{227}\NormalTok{,}\DecValTok{105}\NormalTok{,}\DecValTok{105}\NormalTok{,}\DecValTok{122}\NormalTok{,}\DecValTok{122}\NormalTok{)}
\NormalTok{N <-}\StringTok{ }\KeywordTok{as.integer}\NormalTok{(N)}

\NormalTok{table1 <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(Betas,stderrors,N), }\DataTypeTok{ncol=}\DecValTok{6}\NormalTok{,}\DataTypeTok{nrow=}\DecValTok{3}\NormalTok{, }\DataTypeTok{byrow=}\OtherTok{TRUE}\NormalTok{)}

\KeywordTok{colnames}\NormalTok{(table1) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"FC, # of Children"}\NormalTok{, }\StringTok{"FC, # of Daughters"}\NormalTok{, }\StringTok{"Dem, # of Children"}\NormalTok{, }\StringTok{"Dem, # of Daughters"}\NormalTok{, }\StringTok{"Rep, # of Children"}\NormalTok{, }\StringTok{"Rep, # of Daughters"}\NormalTok{)}
\KeywordTok{rownames}\NormalTok{(table1) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"First Child Female"}\NormalTok{, }\StringTok{"Standard Error"}\NormalTok{, }\StringTok{"N"}\NormalTok{)}

\KeywordTok{print}\NormalTok{(table1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                    FC, # of Children FC, # of Daughters Dem, # of Children
## First Child Female       -0.08388331         1.36262920         0.07291434
## Standard Error            0.14911332         0.07889183         0.18089377
## N                       227.00000000       227.00000000       105.00000000
##                    Dem, # of Daughters Rep, # of Children Rep, # of Daughters
## First Child Female           1.3918003         -0.2823933           1.2295203
## Standard Error               0.1105438          0.2334645           0.1133847
## N                          105.0000000        122.0000000         122.0000000
\end{verbatim}

\end{document}
